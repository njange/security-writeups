# TryHackMe – Passwords: *A Cracking Christmas*

> **Purpose**: This document catalogs the tools, techniques, and workflows used to crack password‑protected files in the TryHackMe room **“Passwords – A Cracking Christmas”**. It is written as a reusable technical reference for a GitHub repository.

> **Scope & Ethics**: All activity described here was performed **inside an authorized TryHackMe lab**. These techniques must only be used where you have **explicit permission**.

---

## Room Overview

* **Platform**: TryHackMe (Learn)
* **Room**: Passwords – A Cracking Christmas (Advent of Cyber – Day 9)
* **Focus**: Offline password cracking of encrypted files
* **Attack Types**:

  * Dictionary attacks
  * Mask / brute‑force attacks

### Learning Objective

Understand how attackers recover weak passwords **without breaking encryption**, by attacking the **password itself** using tooling and wordlists.

---

## Files Targeted

| File       | Type | Protection                 |
| ---------- | ---- | -------------------------- |
| `flag.pdf` | PDF  | User password encryption   |
| `flag.zip` | ZIP  | Password‑protected archive |

---

## Tooling Used

### 1. File Identification

Before cracking, always confirm the file type.

```bash
file flag.pdf
file flag.zip
```

This determines **which extractor and cracking tool** to use.

---

### 2. Wordlists

Primary wordlist used:

* `rockyou.txt`

  * Location (THM Linux VM):

    ```bash
    /usr/share/wordlists/rockyou.txt
    ```
  * Source: Historical leaked passwords
  * Strength: Very fast wins against weak passwords

---

## Cracking Encrypted PDFs

### Tool Options

| Tool          | Purpose                          |
| ------------- | -------------------------------- |
| `pdfcrack`    | Direct PDF password cracking     |
| `pdf2john.pl` | Extract PDF hash for John        |
| `john`        | General‑purpose password cracker |

---

### Method A: `pdfcrack` (Direct Attack)

```bash
pdfcrack -f flag.pdf -w /usr/share/wordlists/rockyou.txt
```

**What this does**:

* Attempts each password from the wordlist
* Tries PDF user‑password authentication
* Stops once the correct password is found

**Result**:

* PDF user password successfully recovered

---

### Method B: John the Ripper (Via Hash Extraction)

#### Step 1: Extract the hash

```bash
pdf2john.pl flag.pdf > pdfhash.txt
```

#### Step 2: Crack with John

```bash
john --wordlist=/usr/share/wordlists/rockyou.txt pdfhash.txt
```

#### Step 3: Show recovered password

```bash
john --show pdfhash.txt
```

---

## Cracking Encrypted ZIP Files

### Tool Options

| Tool        | Purpose                           |
| ----------- | --------------------------------- |
| `zip2john`  | Extract ZIP hash                  |
| `john`      | Crack extracted hash              |
| `fcrackzip` | Direct ZIP cracking (alternative) |

---

### Method: John the Ripper (Recommended)

#### Step 1: Extract ZIP hash

```bash
zip2john flag.zip > ziphash.txt
```

#### Step 2: Crack using a dictionary

```bash
john --wordlist=/usr/share/wordlists/rockyou.txt ziphash.txt
```

#### Step 3: Display cracked password

```bash
john --show ziphash.txt
```

**Result**:

* ZIP archive password successfully recovered
* Contents extracted using `unzip`

---

## Recovered Secrets (Lab Results)

> These values are specific to the TryHackMe lab instance.

### Encrypted PDF – Decrypted Content

```
THM{Cr4ck1ng_PDFs_1s_34$y}
```

### Encrypted ZIP – Decrypted Content

```
THM{Cr4ck1n6_z1p$_1s_34$yyyy}
```

> ⚠️ **Note**: Passwords were recovered during cracking, but the room validates **flags (decrypted content)** rather than reuse of the passwords themselves. In real‑world engagements, recovered passwords must be handled as sensitive material.

---

## Attack Strategy (Generalized)

1. **Identify file type**
2. **Start with a dictionary attack** (fastest ROI)
3. Extract hashes when possible
4. Use **John** for flexibility
5. Escalate to **mask or brute‑force attacks** only if needed

Example mask (Hashcat format):

```
?l?l?l?d?d   # three lowercase letters + two digits
```

---

## Detection & Defensive Notes

Although cracking is **offline**, it leaves strong host‑level indicators:

### Common Indicators

* Execution of:

  * `john`, `hashcat`, `pdfcrack`, `fcrackzip`
* Command‑line patterns:

  * `--wordlist`, `rockyou.txt`, `zip2john`, `pdf2john`
* File artefacts:

  * `~/.john/john.pot`
  * `.hashcat/hashcat.potfile`

### Linux Audit Examples

```bash
auditctl -w /usr/share/wordlists/rockyou.txt -p r -k wordlists_read
auditctl -a always,exit -F exe=/usr/bin/john -k crack_exec
```

### GPU‑Based Cracking Signals

* Sustained high GPU usage
* `nvidia-smi` showing `hashcat` or `john`
* OpenCL / CUDA libraries loaded

---

## Defensive Takeaways

* Encrypted files are only as strong as their passwords
* Weak passwords fall quickly to wordlists
* Use:

  * Long passphrases
  * High entropy
  * MFA where applicable
* Restrict cracking tools to **approved lab environments**

---

## Repository Usage

This document is intended to live at:

```
/docs/tryhackme/passwords-cracking-christmas.md
```

Suitable for:

* Blue team training
* Red team labs
* SOC detection engineering references
* Cybersecurity learning portfolios

---

## Disclaimer

This material is for **educational and defensive security purposes only**. Unauthorized password cracking is illegal and unethical.

---

